# 机器学习导论_作业1

## 1 Basic concepts

### 1.1 Probability

解：
$$
P(D|T)=\frac{P(D)P(T|D)}{P(T|D)·P(D)+P(T|¬D)·P(¬D)}
=\frac{0.01×0.98}{0.98×0.01+0.10×(1-0.01)}=0.09
$$
故Bob有0.1088的概率确实患有该疾病。

### 1.2 Maximum likelihood estimation

解：抛10次该硬币，有8次正面朝上记为事件A，那么有
$$
P(A)=p^8(1-p)^2
$$
记函数 $f(p)=p^8(1-p)^2,0<p<1$
令 $f'(p)=2p^7(1-p)(4-5p)=0,0<p<1$
得  $p = 0.8$

由于$f'(p)>0,(0<p<0.8)$且 $f'(p)<0,(0.8<p<1)$，那么在$p=0.8$时，$f(p)$取得最大值。

也即$p=0.8$时事件A发生的概率最大。故根据MLE，$p$的估计值为0.8.

### 1.3 Performance meause

1）根据$C_1$，$C_2$给出的预测结果分别对样本排序，各样本划分为正例，若当前为真正例，则对应坐标为(x, y + 0.2)，若当前为假正例，则对应坐标为（x + 1/3, y).

① $C_1$:

| $y$  | $yC_1$ |         $(x_i,y_i)$         |
| :--: | :----: | :-------------------------: |
| $1$  | $0.93$ |      $(0,\frac{1}{5})$      |
| $1$  | $0.72$ |      $(0,\frac{2}{5})$      |
| $1$  | $0.62$ |     $(0, \frac{3}{5})$      |
| $1$  | $0.45$ |      $(0,\frac{4}{5})$      |
| $0$  | $0.39$ | $(\frac{1}{3},\frac{4}{5})$ |
| $0$  | $0.32$ | $(\frac{2}{3},\frac{4}{5})$ |
| $1$  | $0.18$ |      $(\frac{2}{3},1)$      |
| $0$  | $0.01$ |           $(1,1)$           |

那么 $AUC_{C_1}=\frac{1}{2}\sum_{i=1}^{7}(x_{i+1}-x_i)(y_i+y_{i+1})=\frac{13}{15}$.



② $C_2$:

| $y$  | $yC_2$ |         $(x_i,y_i)$         |
| :--: | :----: | :-------------------------: |
| $1$  | $0.97$ |      $(0,\frac{1}{5})$      |
| $1$  | $0.89$ |      $(0,\frac{2}{5})$      |
| $1$  | $0.82$ |     $(0, \frac{3}{5})$      |
| $0$  | $0.75$ | $(\frac{1}{3},\frac{3}{5})$ |
| $0$  | $0.36$ | $(\frac{2}{3},\frac{3}{5})$ |
| $1$  | $0.34$ | $(\frac{2}{3},\frac{4}{5})$ |
| $1$  | $0.17$ |      $(\frac{2}{3},1)$      |
| $0$  | $0.12$ |           $(1,1)$           |

那么 $AUC_{C_2}=\frac{1}{2}\sum_{i=1}^{7}(x_{i+1}-x_i)(y_i+y_{i+1})=\frac{11}{15}$.

2）

①当$C_1$设定阈值为0.40时，其混淆矩阵为

| 真实情况/预测结果 |  P   |  N   |
| :---------------: | :--: | :--: |
|     **正例**      |  4   |  1   |
|     **反例**      |  0   |  3   |

$P=\frac{TP}{TP+FP}=1$

$R=\frac{TP}{TP+FN}=\frac{4}{5}$

$F_1=\frac{2×P×R}{P+R}=\frac{8}{9}$

②当$C_2$设定阈值为0.90时，其混淆矩阵为

| <span style="display:inline-block;width:150px">真实情况/预测结果</span> |  P   |  N   |
| :----------------------------------------------------------: | :--: | :--: |
|                           **正例**                           |  1   |  4   |
|                           **反例**                           |  0   |  3   |

$P=\frac{TP}{TP+FP}=1$

$R=\frac{TP}{TP+FN}=\frac{1}{5}$

$F_1=\frac{2×P×R}{P+R}=\frac{1}{3}$



## 2 Linear model

1）

记(2.1)式为$F_w$,

对(2.1)式求导得

$\frac{\partial F_w}{\partial w}=X^T(Xw-y)+2\lambda w$   

$ =(X^TX+2\lambda E)w-2X^Ty\ \ \ \ \ (2.2)$

令(2.2)为0，由于$X$为列满秩，故$X^TX$为正定矩阵，解得通式解如下：

$w^*=(X^TX+2\lambda E)^{-1}X^Ty\ \ \ \ \ (2.2)$

$E$为与$X^TX$同阶单位矩阵.

2）

$\lambda=1$时，(2.2)可写作

$w^*=(X^TX+2E)^{-1}X^Ty\ \ \ \ \ (2.3)$

由训练集有
$$
X = \left[ \matrix{  2 & 9 & 1\\   9 & 3 & 1\\   8 & 3 & 1\\   8 & 8 & 1\\   2 & 1 & 1\\   8 & 4 & 1\\   4 & 3 & 1\\   1 & 8 & 1\\ 3 & 3 & 1\\   5 & 3 & 1\\      } \right]
$$

$$
y=\left[\matrix {290 \\ 1054 \\944 \\ 964 \\246 \\ 948 \\ 488 \\ 167 \\ 370 \\ 598}\right]
$$

代入(2.3)解得
$$
w=\left[\matrix{112.9340\\
   6.1899\\
  11.9795\\}\right]
$$


## 3 Decision Tree

1)

记训练集$D$包含5个训练样例并将这五个样例依序编号为1~5，$|y|=2.$

决策树开始学习时，根节点包含所有样例，正例占$p_1=\frac{3}{5}$,反例占$p_1=\frac{2}{5}$.根节点的信息熵为

$Ent(D)=-\sum^2_{k=1}p_klog_2p_k=-(\frac{3}{5}log_2\frac{3}{5}+\frac{2}{5}log_2\frac{2}{5})=0.971\ .$

属性A有两个可能的取值：$\{1, 1\}$.用该属性对$D$划分得到2个子集，记为$D_1(A=1),D_2(A=0)$.

$D_1$包含编号为$\{1,2,5\}$这3个样例，正例占$\frac{2}{3}$,反例占$\frac{1}{3}$,那么$D_1$的信息熵为

$Ent(D_1)=-(\frac{2}{3}log_2\frac{2}{3}+\frac{1}{3}log_2\frac{1}{3})=0.918\ .$

类似的，我们可计算出$D_2$的信息熵为

$Ent(D_2)=1\ .$

那么属性A的信息增益为

$Gain(D, A)=Ent(D)-\sum^2_v=1\frac{|D^v|}{|D|}Ent(D^v)=0.020\ .$

类似的，我们可计算出其他属性的信息增益：

$Gain(D, B)=0.020\ .$

$Gain(D, C)=0.420\ .$

显然$C$属性的信息增益最大，被选为划分属性。对根节点划分得到：

``` 
                           0         C=?        4
                  +-------------------+--------------------+
                  |                                        |
               {2,3,4}                                   {1,5}
```

左分支结点$D^1=\{2,3,4\}$做进一步划分：

$Ent(D^1)=0.918\ .$

$Gain(D, A)=0.518$

$Gain(D, B)=0.518$

选择字典序较小者A为划分属性。对左分支结点划分得到

```
                           0         C=?        4
                  +-------------------+--------------------+
                  |                                        |
             0   A=?   1                                 {1,5}
         +--------+---------+
         |                  |
       {3,4}               {2}
```

左分支结点$D^2=\{2,3,4\}$做进一步划分.这里只剩下$B$属性作为划分标准。其它分支节点不需要划分。故得到决策树如下：

```
                           0         C=?        1
                  +-------------------+--------------------+
                  |                                        |
             0   A=?   1                                   1
         +--------+---------+
         |                  |
      0 B=? 1               0
    +----+----+
    |         |
    0         1
```

2）根据1）中决策树，测试集输入的对应输出记作y_out,输出如下：

|  A   |  B   |  C   |  y   | y_out |
| :--: | :--: | :--: | :--: | :---: |
|  0   |  0   |  0   |  0   |   0   |
|  0   |  1   |  1   |  1   |   1   |
|  1   |  1   |  1   |  0   |   1   |
|  1   |  0   |  0   |  0   |   0   |

评估结果如下：

| 真实情况/预测结果 |  P   |  N   |
| :---------------: | :--: | :--: |
|     **正例**      |  1   |  0   |
|     **反例**      |  1   |  2   |

$P=\frac{TP}{TP+FP}=\frac{1}{2}$

$R=\frac{TP}{TP+FN}=1$

$F_1=\frac{2×P×R}{P+R}=\frac{2}{3}$

## 4. **Neural network**

